diff --git a/integration/scripts/files/elements/ubuntu-mariadb/pre-install.d/10-percona-apt-key b/integration/scripts/files/elements/ubuntu-mariadb/pre-install.d/10-percona-apt-key
index 55b5ef8..2d31c5a 100755
--- a/integration/scripts/files/elements/ubuntu-mariadb/pre-install.d/10-percona-apt-key
+++ b/integration/scripts/files/elements/ubuntu-mariadb/pre-install.d/10-percona-apt-key
@@ -9,6 +9,10 @@ set -o xtrace
 [ -n "${GUEST_USERNAME}" ] || die "GUEST_USERNAME needs to be set to the user for the guest image"
 [ -n "${RELEASE}" ] || die "RELEASE must be set to either Trusty or Precise"
 
+if [ "$DIB_MYCOMMUNITY_EDITION" == "false" ]; then
+    exit 0
+fi
+
 # Add Percona GPG key
 mkdir -p /home/${GUEST_USERNAME}/.gnupg
 
diff --git a/integration/scripts/files/elements/ubuntu-xenial-mariadb/install.d/30-mariadb b/integration/scripts/files/elements/ubuntu-xenial-mariadb/install.d/30-mariadb
index 521f3e6..033fe34 100755
--- a/integration/scripts/files/elements/ubuntu-xenial-mariadb/install.d/30-mariadb
+++ b/integration/scripts/files/elements/ubuntu-xenial-mariadb/install.d/30-mariadb
@@ -1,4 +1,4 @@
-#!/bin/sh
+#!/bin/bash
 
 # CONTEXT: GUEST during CONSTRUCTION as ROOT
 # PURPOSE: Install controller base required packages
@@ -8,32 +8,46 @@ set -o xtrace
 
 export DEBIAN_FRONTEND=noninteractive
 
-# NOTE(vkmc): Using MariaDB repositories is required
-# https://mariadb.com/kb/en/mariadb/installing-mariadb-deb-files/
-apt-get -y install software-properties-common
-apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xF1656F24C74CD1D8
-add-apt-repository 'deb http://ftp.osuosl.org/pub/mariadb/repo/10.1/ubuntu xenial main'
+if [ "$DIB_MYCOMMUNITY_EDITION" == "true" ]; then
+    # NOTE(vkmc): Using MariaDB repositories is required
+    # https://mariadb.com/kb/en/mariadb/installing-mariadb-deb-files/
+    apt-get -y install software-properties-common
+    apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xF1656F24C74CD1D8
+    add-apt-repository "deb http://ftp.osuosl.org/pub/mariadb/repo/$DIB_MYDBVERSION/ubuntu xenial main"
 
-# Pin MariaDB repository
-sudo echo -e "Package: *\nPin: origin ftp.osuosl.org\nPin-Priority: 1000" > /etc/apt/preferences.d/mariadb.pref
+    # Pin MariaDB repository
+    sudo echo -e "Package: *\nPin: origin ftp.osuosl.org\nPin-Priority: 1000" > /etc/apt/preferences.d/mariadb.pref
+else
+    EXTRA_PKG=libmariadb2
+fi
 
 apt-get -y update
-apt-get -y install socat percona-xtrabackup
-apt-get -y install libmariadbclient18 mariadb-server
+apt-get -y install socat percona-xtrabackup pwgen
+apt-get -y install $EXTRA_PKG mariadb-client mariadb-server
 
 cat >/etc/mysql/conf.d/no_perf_schema.cnf <<_EOF_
 [mysqld]
 performance_schema = off
+
 _EOF_
 
-mv /etc/mysql/my.cnf.fallback /etc/mysql/my.cnf
-chown mysql:mysql /etc/mysql/my.cnf
+rm /etc/mysql/my.cnf                       # This is a symbolic link
 cat >/etc/mysql/my.cnf <<_EOF_
 [mysql]
-
+!includedir /etc/mysql/mariadb.conf.d/
 !includedir /etc/mysql/conf.d/
+
 _EOF_
 
-rm /etc/init.d/mysql
-systemctl daemon-reload
-systemctl enable mariadb
+# Generate random password for mysql root user for initial boot
+pwgen -s 13 1 > /root/.mysql_secret
+chown mysql:root /root/.mysql_secret
+chmod 660 /root/.mysql_secret
+
+chown -R mysql:root /etc/mysql /var/log/mysql
+chmod -R g+rw /etc/mysql /var/log/mysql
+
+if [ "$DIB_MYCOMMUNITY_EDITION" == "true" ]; then
+    rm /etc/init.d/mysql
+    systemctl enable mariadb
+fi
